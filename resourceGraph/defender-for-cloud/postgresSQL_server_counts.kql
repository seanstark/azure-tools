resources
| extend planTypes = tolower('microsoft.dbforpostgresql/servers')
| extend type = tolower(type)
| where planTypes has type
| where tolower(sku.tier) !contains 'basic'
| extend resourceType = 'PostgresSQL Server'
| extend productName = 'Defender for Open Source Databases'
| summarize count = count() by subscriptionId, resourceGroup, productName, resourceType
